---
title: "ISIPs"
author: "Loay Jabre"
date: "July 23, 2018"
output: html_document
editor_options: 
  chunk_output_type: console
---


Load packages and functions. Some packages need to be loaded in this order, or they will clash. 
```{r message=FALSE, warning=FALSE, include=FALSE, results='hide'}
library(ggplot2)
library(plyr)
library(dplyr)
library(gplots)
library(heatmap.plus)
library(RColorBrewer)
library(reshape2)
library(scales)
library(calibrate)
library(tidyr)
library(plotly)
library(gsubfn)
library(ggrepel)
library(gridExtra)
library(htmlwidgets)
library(VennDiagram)
library(caroline)
library(edgeR)
library(manta)

source("fragtranscript_functions.R")
#library(scatterplot3d)
#library(rgl)
```
 
Upload ORF and MCL cluster files, and extract only Fragilariopsis and Pseudo-nitzchia data.  
```{r message=FALSE, warning=FALSE, include=FALSE}
allMCL <- read.csv("allMCL.csv", header = TRUE, sep = "," )
allMCL$name <- paste (allMCL$cluster, allMCL$ann_desc, allMCL$Taxa.group)
FragMCL <- dplyr::filter (allMCL, grepl('Fragilariopsis', Taxa.group))
PseudoMCL <- dplyr::filter (allMCL, grepl('Pseudo-nit', Taxa.group))
alldiatomsMCL <- dplyr::filter (allMCL, grepl('Pseudo-nit|Fragilariopsis|Diatom', Taxa.group))

all <- read.csv("allORF.csv", header = TRUE, sep = "," )
all$name <- paste(all$orf_id, all$cluster, all$kegg_desc, all$KO_desc, all$KO_pathway, all$KOG_desc, all$KOG_class, all$best_hit_annotation, all$PFams_desc, all$TIGRFams_desc)
all <- dplyr::filter (all, !grepl('^$', grpnorm_taxgrp))
alldiatomsORF <- dplyr::filter (all, grepl('Pseudo-nit|Fragilariopsis|Diatom',grpnorm_taxgrp))

PseudoORF <- dplyr::filter (all, grepl('Pseudo-nitzschi', grpnorm_taxgrp))
PseudoORF <- dplyr::filter (PseudoORF, grepl('Eukar', domain))
FragORF <- dplyr::filter (all, grepl('Fragilariopsis', grpnorm_taxgrp))
FragORF <- dplyr::filter (FragORF, grepl('Eukar', domain))

allnew <- read.csv("tfg_de_annotation_allTFG.grpnorm_mmetsp_fc_pn_reclassified.csv")
```


Look at overall general trends in the data. 
```{r}


volcanoplotMCL(FragMCL,"X12_vs_16.log2fc", "X12_vs_16.fdr", "TFG_t5_1A", "TFG_t5_1B", "TFG_t5_1C", "TFG_t5_7A", "TFG_t5_7B", "TFG_t5_7C", "Temp Test: 0C_VS_6C" )


  volcano <- FragMCL[c(1,76, 58, 59, 28:30, 40:42)]
  names(volcano) <- c("taxon", "gene", "Fold", "FDR", "a", "b", "c", "d", "e", "f")
  volcano ["group"] <- "no-fold-change"
  #volcano$Fe <- volcano$Fe+2  
 # volcano$noFe <- volcano$noFe+2
  
  volcano['size'] <- log(rowMeans( volcano[, c(5:10)] )+1)
  #volcano['size'] <- ((volcano$Fe)+(volcano$noFe))/2
  #volcano['size'] <- (log2(volcano$Fe))+(log2(volcano$noFe))
  #volcano['size'] <- (log2(((volcano$Fe)+(volcano$noFe))/2))
  #volcano['size'] <- (log2((volcano$Fe)+(volcano$noFe)))

  volcano [which(volcano['FDR'] < 0.05 & abs(volcano['Fold']) < 2), "group"]<- "nofoldchange_significant" 
  
  volcano [which(volcano ['FDR'] > 0.05 & abs(volcano['Fold'])> 2), "group"] <- "fold-change_notsignificant"
  
  volcano [which(volcano ['FDR'] < 0.05 & abs(volcano['Fold']) > 2), "group"] <- "fold-change_significant"

  ggplot (data = volcano, aes(x= Fold, y=-log10(FDR), color= group)) +
    geom_point (alpha=0.7,size =  volcano$size, shape = 19 )+
    geom_hline (yintercept = 1.301, col = "blue", lty = 2, lwd=0.5 )+
    geom_vline (xintercept = c(-2,2), col = "blue", lty = 2, lwd=0.5 )+
    xlab("Log2 Fold Change")+ ylab("-Log10 FDR")+
    ggtitle('graphtitle')+
    theme_bw()+
    theme(plot.title = element_text(hjust = 0.5))
  



  
  
  
  
  x <- list (title ="Log2 Fold Change")
  y <- list (title = "-Log10 FDR")
  plot_ly(data = volcano, x = volcano$Fold, y = -log10(volcano$FDR), text = volcano$gene, mode = "markers", color = volcano$group, size = ~size ) %>% 
    layout (xaxis = x, yaxis = y)
  
volcanoplotMCLinteractive(FragMCL, "X12_vs_17.log2fc", "X12_vs_17.fdr", "Temp Test: 0C_VS_3C")
volcanoplot(all, "X12_vs_16.log2fc", "X12_vs_16.fdr", "Temp Test: 0C_VS_6C")
volcanoplot(all, "X14_vs_16.log2fc", "X14_vs_16.fdr", "Temp Test: 3C_VS_6C")
volcanoplot(all, "X12_vs_13.log2fc", "X12_vs_13.fdr", "Fe Test: 0C_VS_Fe0C")
volcanoplot(all, "X14_vs_15.log2fc", "X14_vs_15.fdr", "Fe Test: 3C_VS_Fe3C")
volcanoplote(all, "X16_vs_17.log2fc", "X16_vs_17.fdr", "Fe Test: 6C_VS_Fe6C")
volcanoplot(all, "X12_vs_15.log2fc", "X12_vs_15.fdr", "Synergy Test: 0C_VS_Fe3C")
volcanoplote(all, "X12_vs_17.log2fc", "X12_vs_17.fdr", "Synergy Test: 0C_VS_Fe6C")
```


Manta plots
```{r}
mantadata <- allMCL [,c(2,1,28,29,30,43,44,45)]
mantadata <- dplyr::filter (mantadata, grepl('Pseudo-nitzschia|Diatom|Fragilariopsis', Taxa.group))
mantadata$cluster <- make.unique(as.character(mantadata$cluster), sep ="_")
mantadata <- mantadata [,-c(2)]
  
    colname <- "mean"
  i=0
  while (i < 2){
    colname <- paste(colname, i)
    col1 = 2+(i*3)
    col2 = 4+(i*3)
   mantadata[[colname]] <- rowMeans( mantadata[, c(col1:col2)] )
    i <- i+1
  }
  
  
mantadata <- mantadata [,-c(2:7)]


mantadata <-data.frame(mantadata[,-1], row.names = mantadata [,1])
names(mantadata)<- c('0C_0Fe', '6C_+Fe')




mantadata.annot <- allMCL [,c(2,6, 4,5,1)]
mantadata.annot <- dplyr::filter (mantadata.annot, grepl('Pseudo-nitzschia|Diatom|Fragilariopsis', Taxa.group))
mantadata.annot$cluster <- make.unique(as.character(mantadata.annot$cluster), sep ="_")

mantadata.annot %>% mutate_if(is.factor, as.character) -> mantadata.annot

#mantadata.annot$ann_desc[mantadata.annot$ann_desc==""] <- "NA"
#mantadata.annot$ann_type[mantadata.annot$ann_type==""] <- "NA"
#mantadata.annot$ann_id[mantadata.annot$ann_id==""] <- "NA"



obj1 <- counts2manta(mantadata, annotation = mantadata.annot, a.merge.clmn = 'cluster', agg.clmn = 'ann_desc', meta.clmns = c('Taxa.group','ann_type'), gene.clmns = c('ann_desc', 'ann_type', 'ann_id'))


#plot(obj1, main='Diatom Gene Expression\n at Ocean Station Papa', meta.lev='Taxa.group', lgd.pos='bottomright')

#plot(obj1, main='+/-FE', meta.lev='Taxa.group', lgd.pos='bottomright')


manta.ra(obj1, uniques=0, meta.level = 'Taxa.group', main ="-Fe0C vs +Fe6C" )


caroline::hyperplot(obj1,annout = mantadata.annot, browse=TRUE, cex = 1, w = 72 * 8, h = 72 * 6 , main=main.hov)


#plot(obj1, uniques=1,  meta.level = 'Taxa.group', main ="-Fe0C vs +Fe6C")


volcanoplotMCL(DiatomMCL, "X12_vs_17.log2fc", "X12_vs_17.fdr", "Synergy Test: 0C_VS_Fe3C")

#obj <- counts2manta(cts, annotation=cts.annot,
#+ a.merge.clmn='query_seq', agg.clmn='what_def', meta.clmns=c('family','genus_sp'),
#+ gene.clmns=c('what_def','kid','pathway'))





```
 
Number of DE transcrips  
```{r}

sub_allnew <- allnew [, c(8:52, 114,115:131, 2, 96, 97, 6:7, 3:5)]


sum(allnew$temp_6vstemp_05 !=0)

sum(allnew$X12_vs_16.fdr <0.05)

sum(all$X12_vs_14.fdr <0.001)
sum(all$X12_vs_16.fdr <0.001)

sum(all$X12_vs_13.fdr <0.001)
sum(all$X14_vs_15.fdr <0.001)
sum(all$X16_vs_17.fdr <0.001)


all$zerocolumn <- all$TFG_t5_1A+all$TFG_t5_1B+all$TFG_t5_1C
sum(all$zerocolumn ==0)




newORF <- dplyr::filter(newORF, grepl('Pseudo-nit|Fragilariopsis|Diatom',grpnorm_taxgrp))

newORF <- newORF [, -c(1,2,29:34)]

newORF[,8:25] <- newORF$norm_factors_group*newORF[,8:25]

newanalysis <- cbind(allnew, newORF)
names(newanalysis)[1] <- 'Jjdjd'
newanalysis <- newanalysis [, c(1,115,2:114, 116:141 )]
newanalysis[,66:83]<- newanalysis$norm_factors_group*newanalysis[,66:83]
newdata <- newanalysis [, -c(1,116:141, 109, 46:64 )]
newdata <- newdata [, c(88, 46:87, 89:94)]
newdata1 <- newdata [, c(1, 21, 39, 43, 45, 23, 46, 27, 47, 25, 48, 29, 49)]

```

 RA plot
```{r}
RAp <- read.csv("RA.csv")
raPlot(mantadata$`0C_0Fe`, mantadata$`6C_+Fe`, uniques = 0)




RA <- raPlot(RAp$noFe, RAp$Fe, uniques = TRUE, jitter = 0.3)
cond.unique <- apply(cbind(RAp$noFe, RAp$Fe), 1, function(d) any(d==0))
points(RA$A,RA$R, col=c('black','orange')[cond.unique+1])

RA <- raPlot(FragMCL$TFG_t5_1B, FragMCL$TFG_t5_7C, pch = '', uniques = FALSE)
cond.unique <- apply(cbind(FragMCL$TFG_t5_1B,FragMCL$TFG_t5_7C), 1, function(d) any(d==0))
points(RA$A,RA$R, col=c('black','orange')[cond.unique+1])

RA <- raPlot(a, b, pch='')
cond.unique <- apply(cbind(a,b), 1, function(d) any(d==0))
points(RA$A,RA$R, col=c('black','orange')[cond.unique+1])


            
#use EdgeR to identify outliers 

```
 

#Rhodopsin plots
```{r}
ISIP <- dplyr::filter (FragORF, grepl('rhodopsin|Rhodopsin', name))
volcanoplotinteractive(ISIP, "X12_vs_14.log2fc", "X12_vs_14.fdr", "Temp Test: 0C_VS_3C")
volcanoplotinteractive(ISIP, "X12_vs_16.log2fc", "X12_vs_16.fdr", "Temp Test: 0C_VS_6C")
volcanoplotinteractive(ISIP, "X14_vs_16.log2fc", "X14_vs_16.fdr", "Temp Test: 3C_VS_6C")
volcanoplotinteractive(ISIP, "X12_vs_13.log2fc", "X12_vs_13.fdr", "Fe Test: 0C_VS_Fe0C")
volcanoplotinteractive(ISIP, "X14_vs_15.log2fc", "X14_vs_15.fdr", "Fe Test: 3C_VS_Fe3C")
volcanoplotinteractive(ISIP, "X16_vs_17.log2fc", "X16_vs_17.fdr", "Fe Test: 6C_VS_Fe6C")
  volcanoplotinteractive(ISIP, "X12_vs_15.log2fc", "X12_vs_15.fdr", "Synergy Test: 0C_VS_Fe3C")
#interesting synergy test. 
volcanoplotinteractive(ISIP, "X12_vs_17.log2fc", "X12_vs_17.fdr", "Synergy Test: 0C_VS_Fe6C")


heatmap_unclustered(group, ISIP, "clust_231 ")
heatmap(group, ISIP, "rhodopsin|Rhodopsin")

 MCLclusterrawplot (FragMCL, '^clust_231$', "Rhodopsin - cluster 231 Frag")
R1p <- MCLclusterrawplot (PseudoMCL, '^clust_231$', "Rhodopsin - cluster 231 Pseudo")
R2f <- MCLclusterrawplot (FragMCL, '^clust_1548$', "Rhodopsin - cluster 1548 Frag")
R2p <- MCLclusterrawplot (PseudoMCL, '^clust_1548$', "Rhodopsin - cluster 1548 Pseudo")
R3f <- MCLclusterrawplot (FragMCL, '^clust_10297$', "Rhodopsin - cluster 10297 Frag")
R3p <- MCLclusterrawplot (PseudoMCL, '^clust_10297$', "Rhodopsin - cluster 10297 Pseudo")
R4f <- MCLclusterrawplot (FragMCL, '^clust_19837$', "Rhodopsin - cluster 19837 Frag")
R4p <- MCLclusterrawplot (PseudoMCL, '^clust_19837$', "Rhodopsin - cluster 19837 Pseudo")

MCLclusterrawplot (FragMCL, '^clust_231$', "Rhodopsin - cluster 231 Frag")

grid.arrange(R1f, R1p, R2f, R2p, R3f, R3p, nrow=3, ncol=2)

x<- ORFplots(FragORF, "^clust_231$", 'titile')

ggplotly(x)

ORFplots(FragORF, "^clust_19837$", 'titile')

ISIP <- dplyr::filter (FragORF, grepl('^clust_231$', cluster))

```



#ISIP plots 
```{r}
#Volcano plots for the different treatments for Frag. 

ISIP <- dplyr::filter (PseudoORF, grepl('ISIP|isip', name))
volcanoplotinteractive(ISIP, "X12_vs_14.log2fc", "X12_vs_14.fdr", "Temp Test: 0C_VS_3C")
volcanoplotinteractive(ISIP, "X12_vs_16.log2fc", "X12_vs_16.fdr", "Temp Test: 0C_VS_6C")
volcanoplotinteractive(ISIP, "X14_vs_16.log2fc", "X14_vs_16.fdr", "Temp Test: 3C_VS_6C")
volcanoplotinteractive(ISIP, "X12_vs_13.log2fc", "X12_vs_13.fdr", "Fe Test: 0C_VS_Fe0C")
volcanoplotinteractive(ISIP, "X14_vs_15.log2fc", "X14_vs_15.fdr", "Fe Test: 3C_VS_Fe3C")
volcanoplotinteractive(ISIP, "X16_vs_17.log2fc", "X16_vs_17.fdr", "Fe Test: 6C_VS_Fe6C")
volcanoplotinteractive(ISIP, "X12_vs_15.log2fc", "X12_vs_15.fdr", "Synergy Test: 0C_VS_Fe3C")
volcanoplotinteractive(ISIP, "X12_vs_17.log2fc", "X12_vs_17.fdr", "Synergy Test: 0C_VS_Fe6C")

ISIP <- dplyr::filter (PseudoORF, grepl('ISIP|isip', name))
volcanoplotinteractive(ISIP, "X12_vs_14.log2fc", "X12_vs_14.fdr", "Temp Test: 0C_VS_3C")    
volcanoplotinteractive(ISIP, "X12_vs_16.log2fc", "X12_vs_16.fdr", "Temp Test: 0C_VS_6C")     
volcanoplotinteractive(ISIP, "X14_vs_16.log2fc", "X14_vs_16.fdr", "Temp Test: 3C_VS_6C")
volcanoplotinteractive(ISIP, "X12_vs_13.log2fc", "X12_vs_13.fdr", "Fe Test: 0C_VS_Fe0C")
volcanoplotinteractive(ISIP, "X14_vs_15.log2fc", "X14_vs_15.fdr", "Fe Test: 3C_VS_Fe3C")
volcanoplotinteractive(ISIP, "X16_vs_17.log2fc", "X16_vs_17.fdr", "Fe Test: 6C_VS_Fe6C")
volcanoplotinteractive(ISIP, "X12_vs_15.log2fc", "X12_vs_15.fdr", "Synergy Test: 0C_VS_Fe3C")
volcanoplotinteractive(ISIP, "X12_vs_17.log2fc", "X12_vs_17.fdr", "Synergy Test: 0C_VS_Fe6C")


heatmap(group, FragORF, "ISIP1")
heatmap(group, FragORF, "ISIP2")
heatmap(group, FragORF, "ISIP3")

heatmap(group, PseudoORF, "ISIP1")
heatmap(group, PseudoORF, "ISIP2")
heatmap(group, PseudoORF, "ISIP3")


I1f<- MCLclusterrawplot (FragMCL, '^clust_1814$', "ISIP1 - cluster 1814Frag")
I1p<- MCLclusterrawplot (PseudoMCL, '^clust_1814$', "ISIP1 - cluster 1814Pseudo")
I2f <- MCLclusterrawplot (FragMCL,'clust_9740', "ISIP2A - cluster 9740Frag")
I2p <- MCLclusterrawplot (PseudoMCL,'clust_9740', "ISIP2A - cluster 9740Pseudo")
I3f <- MCLclusterrawplot (FragMCL,'clust_1154', "ISIP3 - cluster 1154Frag")
I3p <- MCLclusterrawplot (PseudoMCL,'clust_1154', "ISIP3 - cluster 1154Pseudo")
#I4 <- MCLclusterrawplot (FragMCL,'clust_25598', "ISIP2A - cluster 25598 (not significant)")
grid.arrange(I1f,I1p,I2f,I2p, I3f, I3p, nrow=3, ncol=2)

```




#Nitrogen 
```{r}
NiR <- MCLclusterrawplot(FragMCL, '^clust_411$', "Nitrate reductase - cluster 411Frag")
NiRP <- MCLclusterrawplot(PseudoMCL, '^clust_411$', "Nitrate reductase - cluster 411Pseudo")
NitTrans <- MCLclusterrawplot(FragMCL, '^clust_991$', "Nitrate transporter portein - cluster 991Frag")
NitTransP <- MCLclusterrawplot(PseudoMCL, '^clust_991$', "Nitrate transporter portein - cluster 991Pseudo")
NR <- MCLclusterrawplot(FragMCL, '^clust_3563$', "Nitrite reductase - cluster 3563Frag")
NRP <- MCLclusterrawplot(PseudoMCL, '^clust_3563$', "Nitrite reductase - cluster 3563Pseudo")

heatmap(group, FragORF, "ISIP")



#Urease <- MCLclusterrawplot(FragMCL, '^clust_927$', "Urease - cluster 927Frag")
#UreaseP <- MCLclusterrawplot(PseudoMCL, '^clust_927$', "Urease - cluster 927Pseudo")
#URED <- MCLclusterrawplot(FragMCL, '^clust_20535$', "Urease Accessory Protein UreD - cluster 20535Frag")
#UREDP <- MCLclusterrawplot(PseudoMCL, '^clust_20535$', "Urease Accessory Protein UreD - cluster 20535Pseudo")
#grid.arrange(NiR, NiRP, NitTrans, NitTransP, NR,NRP, Urease, UreaseP, URED,UREDP,  nrow=6, ncol=2)

grid.arrange(NiR, NiRP, NitTrans, NitTransP, NR,NRP,  nrow=3, ncol=2)

ISIP <- dplyr::filter (FragORF, grepl('nitrite|Nitrite|nitrate|Nitrate', name))
volcanoplotinteractive(ISIP, "X12_vs_14.log2fc", "X12_vs_14.fdr", "Temp Test: 0C_VS_3C")
volcanoplotinteractive(ISIP, "X12_vs_16.log2fc", "X12_vs_16.fdr", "Temp Test: 0C_VS_6C")
volcanoplotinteractive(ISIP, "X14_vs_16.log2fc", "X14_vs_16.fdr", "Temp Test: 3C_VS_6C")
volcanoplotinteractive(ISIP, "X12_vs_13.log2fc", "X12_vs_13.fdr", "Fe Test: 0C_VS_Fe0C")
volcanoplotinteractive(ISIP, "X14_vs_15.log2fc", "X14_vs_15.fdr", "Fe Test: 3C_VS_Fe3C")
volcanoplotinteractive(ISIP, "X16_vs_17.log2fc", "X16_vs_17.fdr", "Fe Test: 6C_VS_Fe6C")
volcanoplotinteractive(ISIP, "X12_vs_15.log2fc", "X12_vs_15.fdr", "Synergy Test: 0C_VS_Fe3C")
volcanoplotinteractive(ISIP, "X12_vs_17.log2fc", "X12_vs_17.fdr", "Synergy Test: 0C_VS_Fe6C")



GS<- MCLclusterrawplot(FragMCL, '^clust_589$', "Glutamine Synthetase - cluster 589Frag")
GSP<- MCLclusterrawplot(PseudoMCL, '^clust_589$', "Glutamine Synthetase - cluster 589Pseudo")
GaS <- MCLclusterrawplot(FragMCL, '^clust_241$', "Glutamate Synthase - cluster 241Frag")

GaSP <- MCLclusterrawplot(PseudoMCL, '^clust_241$', "Glutamate Synthase - cluster 241Pseudo")
grid.arrange(GS,GSP, GaS, GaSP, nrow=2, ncol=2)

MCLclusterrawplot(MCL, '^clust_999$', "Nitrite reductase - cluster 3563")

LHC <- dplyr::filter (ORF, grepl('transaminase', name))

NiRMCL <- dplyr::filter(FragORF, grepl ('ferritin|Ferritin', name))


MCLclusterrawplot (PseudoMCL, '^clust_4956$', "Nitric Oxide Synthase -cluster 4956 Pseudo")

MCLclusterrawplot (FragMCL, '^clust_4956$', "Nitric Oxide Synthase - cluster 4956 Frag")
MCLclusterrawplot (FragMCL, '^clust_16690$', "Nitric Oxide Synthase Frag")

MCLclusterrawplot (PseudoMCL, '^clust_15657$', "Nitric Oxide Synthase Frag")


#Nitric oxide and iron in plants:an emerging and converging story. Interaction with ferritin ? 

```




#Flavodoxin Frag
```{r}
flavodoxin <- dplyr::filter(FragORF, grepl ('flavodoxin|Flavodoxin', name))
flavodoxin <- dplyr::filter(FragMCL, grepl ('flavodoxin|Flavo', name))



MCLclusterrawplot (FragMCL, '^clust_534$', " Frag-Flavodoxin- cluster534")

x <- ORFplots(FragORF, "^clust_534$", "title")
ggplotly(x)

contigplots(FragORF,"contig_1360422_94_705+", "Frag-Flavodoxin-cluster534-contig_1175010_45_704_+")

 contigplots(FragORF,"644824_210_908+", "Frag-Flavodoxin-cluster534-contig_1360422_94_705_+")


volcanoplotinteractive(flavodoxin, "X12_vs_14.log2fc", "X12_vs_14.fdr", "Temp Test: 0C_VS_3C")
volcanoplotinteractive(flavodoxin, "X12_vs_16.log2fc", "X12_vs_16.fdr", "Temp Test: 0C_VS_6C")
volcanoplotinteractive(flavodoxin, "X14_vs_16.log2fc", "X14_vs_16.fdr", "Temp Test: 3C_VS_6C")
volcanoplotinteractive(flavodoxin, "X12_vs_13.log2fc", "X12_vs_13.fdr", "Fe Test: 0C_VS_Fe0C")
volcanoplotinteractive(flavodoxin, "X14_vs_15.log2fc", "X14_vs_15.fdr", "Fe Test: 3C_VS_Fe3C")
volcanoplotinteractive(flavodoxin, "X16_vs_17.log2fc", "X16_vs_17.fdr", "Fe Test: 6C_VS_Fe6C")
volcanoplotinteractive(flavodoxin, "X12_vs_15.log2fc", "X12_vs_15.fdr", "Synergy Test: 0C_VS_Fe3C")
volcanoplotinteractive(flavodoxin, "X12_vs_17.log2fc", "X12_vs_17.fdr", "Synergy Test: 0C_VS_Fe6C")

volcanoplot(flavodoxin, "X12_vs_17.log2fc", "X12_vs_17.fdr", "Synergy Test: 0C_VS_Fe6C")

MCLclusterrawplot (FragMCL, '^clust_534$', "Flavodoxin cluster 534. Frag")
MCLclusterrawplot (FragMCL, '^clust_4660$', "Iron responsive Flavodoxin in F. cylindrus")
MCLclusterrawplot (FragMCL, '^clust_6705$', "Iron responsive Flavodoxin in F. cylindrus")
flavodoxin <- dplyr::filter(FragORF, grepl ('flavodoxin|Flavodoxin', name))

MCLclusterrawplot (FragMCL, '^clust_1452$', "Flavodoxin cluster 534. Frag")
MCLclusterrawplot (FragMCL, '^clust_1816$', "Flavodoxin cluster 534. Frag")
MCLclusterrawplot (FragMCL, '^clust_3563$', "Flavodoxin cluster 534. Frag")

ORFplots(FragORF, "^clust_534$", "title")
ORFplots(FragORF, "^clust_4660$", "title")
ORFplots(FragORF, "^clust_6705", "title")


```


#Flavodoxin Pseudo
```{r}
flavodoxin <- dplyr::filter(PseudoORF, grepl ('flavodoxin|Flavodoxin', name))

flavodoxinMCL <- dplyr::filter(PseudoMCL, grepl ('flavodoxin|Flavodoxin', name))

volcanoplotinteractive(flavodoxin, "X12_vs_14.log2fc", "X12_vs_14.fdr", "Temp Test: 0C_VS_3C")
volcanoplotinteractive(flavodoxin, "X12_vs_16.log2fc", "X12_vs_16.fdr", "Temp Test: 0C_VS_6C")
volcanoplotinteractive(flavodoxin, "X14_vs_16.log2fc", "X14_vs_16.fdr", "Temp Test: 3C_VS_6C")
volcanoplotinteractive(flavodoxin, "X12_vs_13.log2fc", "X12_vs_13.fdr", "Fe Test: 0C_VS_Fe0C")
volcanoplotinteractive(flavodoxin, "X14_vs_15.log2fc", "X14_vs_15.fdr", "Fe Test: 3C_VS_Fe3C")
volcanoplotinteractive(flavodoxin, "X16_vs_17.log2fc", "X16_vs_17.fdr", "Fe Test: 6C_VS_Fe6C")
volcanoplotinteractive(flavodoxin, "X12_vs_15.log2fc", "X12_vs_15.fdr", "Synergy Test: 0C_VS_Fe3C")
volcanoplotinteractive(flavodoxin, "X12_vs_17.log2fc", "X12_vs_17.fdr", "Synergy Test: 0C_VS_Fe6C")


MCLclusterrawplot (FragMCL, '^clust_534$', "Non-Iron responsive Flavodoxin in Fragilariopsis spp.")
MCLclusterrawplot (FragMCL, '^clust_4660$', "Iron responsive Flavodoxin in Fragilariopsis spp.")
MCLclusterrawplot (FragMCL, '^clust_6705$', "Iron responsive Flavodoxin in F. cylindrus")

x <-ORFplots(PseudoORF, "^clust_534$", "clust_534")

ggplotly(x)

contigplots(PseudoORF,"contig_678095_1_656_+", "Pseudo-Flavodoxin-cluster534-contig_678095_1_656_+" )


```




#List of significant MCL clusters Extract only Significant genes 
```{r}
volcano <- FragMCL[c("name", "X12_vs_14.log2fc", "X12_vs_14.fdr")]
names(volcano) <- c("gene", "Fold", "FDR")

volcano <- volcano [volcano$FDR <0.1, ]



LHC <- dplyr::filter (ORF, grepl('nitrite', name))
#LHC <- dplyr::filter (MCL, grepl('Photosystem|photosystem', name))


volcanoplotinteractive(LHC, "X12_vs_14.log2fc", "X12_vs_14.fdr", "Temp Test: 0C_VS_3C")    
volcanoplotinteractive(LHC, "X12_vs_16.log2fc", "X12_vs_16.fdr", "Temp Test: 0C_VS_6C")     
volcanoplotinteractive(LHC, "X14_vs_16.log2fc", "X14_vs_16.fdr", "Temp Test: 3C_VS_6C")
volcanoplotinteractive(LHC, "X12_vs_13.log2fc", "X12_vs_13.fdr", "Fe Test: 0C_VS_Fe0C")
volcanoplotinteractive(LHC, "X14_vs_15.log2fc", "X14_vs_15.fdr", "Fe Test: 3C_VS_Fe3C")
volcanoplotinteractive(LHC, "X16_vs_17.log2fc", "X16_vs_17.fdr", "Fe Test: 6C_VS_Fe6C")
volcanoplotinteractive(FragMCL, "X12_vs_15.log2fc", "X12_vs_15.fdr", "Synergy Test: 0C_VS_Fe3C")
volcanoplotinteractive(LHC, "X12_vs_17.log2fc", "X12_vs_17.fdr", "Synergy Test: 0C_VS_Fe6C")

```





```{r}
  
volcanoplotinteractive(LHC, "X12_vs_14.log2fc", "X12_vs_14.fdr", "Temp Test: 0C_VS_3C")    
volcanoplotinteractive(LHC, "X12_vs_16.log2fc", "X12_vs_16.fdr", "Temp Test: 0C_VS_6C")     
volcanoplotinteractive(LHC, "X14_vs_16.log2fc", "X14_vs_16.fdr", "Temp Test: 3C_VS_6C")
volcanoplotinteractive(LHC, "X12_vs_13.log2fc", "X12_vs_13.fdr", "Fe Test: 0C_VS_Fe0C")
volcanoplotinteractive(LHC, "X14_vs_15.log2fc", "X14_vs_15.fdr", "Fe Test: 3C_VS_Fe3C")
volcanoplotinteractive(LHC, "X16_vs_17.log2fc", "X16_vs_17.fdr", "Fe Test: 6C_VS_Fe6C")
volcanoplotinteractive(LHC, "X12_vs_15.log2fc", "X12_vs_15.fdr", "Synergy Test: 0C_VS_Fe3C")
volcanoplotinteractive(LHC, "X12_vs_17.log2fc", "X12_vs_17.fdr", "Synergy Test: 0C_VS_Fe6C_Frag")
```
  
  



#This chunk here is for exploring new things. 
```{r}
explore <- dplyr::filter(FragORF, grepl ('betaine', name))





MCLclusterrawplot (FragMCL, '^clust_611$', "fructose adolase")

MCLclusterrawplot (FragMCL, '^clust_8542$', "fructose adolase")

```




#Light Harvesting Complexes
```{r}
F1 <- MCLclusterrawplot(FragMCL,'^clust_1236$', "LHCf1 - cluster 1236Frag")
F1P <- MCLclusterrawplot(PseudoMCL,'^clust_1236$', "LHCf1 - cluster 1236Pseudo")

F2 <- MCLclusterrawplot(FragMCL, '^clust_1194$', "LHCf4 - cluster 1194Frag")
F2P <- MCLclusterrawplot(PseudoMCL, '^clust_1194$', "LHCf4 - cluster 1194Pseudo")

grid.arrange(F1, F1P, F2, F2P,nrow=2, ncol=2)

X1 <- MCLclusterrawplot('^clust_712$', "LHCx1 - cluster 712")
X2 <- MCLclusterrawplot('^clust_960$', "LHCx5 - cluster 960")
X3 <- MCLclusterrawplot('^clust_1787$', "LHCx6 - cluster 1787")
grid.arrange(X1, X2, X3, nrow=2, ncol=2)

MCLclusterplot('clust_1550 ', "PSII Cytb559 - cluster 1550")

MCLclusterplot('clust_38070 ', "Chl A/B binding - 38070")
MCLclusterplot('clust_646 ', "Chl A/B binding - 646")
MCLclusterplot('clust_195 ', "Chl A/B binding - 195")
MCLclusterplot('clust_534 ', "Flavodoxin - 534")



A1 <- MCLclusterrawplot(FragMCL, '^clust_6705$', "Flavodoxin - cluster 6705 Frag")

A2 <- MCLclusterrawplot(FragMCL, '^clust_534$', "Flavodoxin 1 - cluster 534 Frag")

A3 <- MCLclusterrawplot(FragMCL, '^clust_4907$', "Flavodoxin - cluster 4907 Frag")
A4 <- MCLclusterrawplot(FragMCL, '^clust_4660$', "Flavodoxin - cluster 4660 Frag")
A5 <- MCLclusterrawplot(FragMCL, '^clust_33174$', "Flavodoxin-like fold - cluster 33174 Frag")
A6 <- MCLclusterrawplot(FragMCL, '^clust_12773$', "Flavodoxin - cluster 12773 Frag")



A1 <- MCLclusterrawplot(PseudoMCL, '^clust_6705$', "Flavodoxin - cluster 6705 Pseudo")

A2 <- MCLclusterrawplot(PseudoMCL, '^clust_534$', "Flavodoxin 1 - cluster 534 Pseudo")

A3 <- MCLclusterrawplot(PseudoMCL, '^clust_4907$', "Flavodoxin - cluster 4907 Pseudo")
A4 <- MCLclusterrawplot(PseudoMCL, '^clust_4660$', "Flavodoxin - cluster 4660 Pseudo")
A5 <- MCLclusterrawplot(PseudoMCL, '^clust_33174$', "Flavodoxin-like fold - cluster 33174 Pseudo")
A6 <- MCLclusterrawplot(PseudoMCL, '^clust_12773$', "Flavodoxin - cluster 12773 Pseudo")






grid.arrange(A1, A2, A3, A4, A5, A6, nrow=3, ncol=2)




LHC <- dplyr::filter (FragMCL, grepl('Flavodoxin|flavodoxin', name))

```



# ORF volcano for core antenna
```{r}
LHC <- dplyr::filter (PseudoORF, grepl('rhod|Rhod', name))
#LHC <- dplyr::filter (MCL, grepl('Photosystem|photosystem', name))


volcanoplotinteractive(LHC, "X12_vs_14.log2fc", "X12_vs_14.fdr", "Temp Test: 0C_VS_3C")    
volcanoplotinteractive(LHC, "X12_vs_16.log2fc", "X12_vs_16.fdr", "Temp Test: 0C_VS_6C")     
volcanoplotinteractive(LHC, "X14_vs_16.log2fc", "X14_vs_16.fdr", "Temp Test: 3C_VS_6C")
volcanoplotinteractive(LHC, "X12_vs_13.log2fc", "X12_vs_13.fdr", "Fe Test: 0C_VS_Fe0C")
volcanoplotinteractive(LHC, "X14_vs_15.log2fc", "X14_vs_15.fdr", "Fe Test: 3C_VS_Fe3C")
volcanoplotinteractive(LHC, "X16_vs_17.log2fc", "X16_vs_17.fdr", "Fe Test: 6C_VS_Fe6C")
volcanoplotinteractive(LHC, "X12_vs_15.log2fc", "X12_vs_15.fdr", "Synergy Test: 0C_VS_Fe3C")
volcanoplotinteractive(LHC, "X12_vs_17.log2fc", "X12_vs_17.fdr", "Synergy Test: 0C_VS_Fe6C")
```




#All of ISIP2A in the ORF
```{r}
ISIP <- dplyr::filter (ORF, grepl('clust_7576', name))
ISIP1 <- ISIP [-c(1:46,50:64, 83:106)]
ISIP1 <- ISIP1 [c(22, 1:21)]
names(ISIP1)<- c("name", "A_T0", "B_T0", "C_T0", "A_0.5", "B_0.5", "C_0.5", "A_Fe_0.5", "B_Fe_0.5", "C_Fe_0.5", "A_3", "B_3", "C_3", "A_Fe_3", "B_Fe_3", "C_Fe_3","A_6", "B_6", "C_6", "A_Fe_6", "B_Fe_6", "C_Fe_6")

ISIP1  <- dplyr::filter (ISIP1, grepl('_75', name))

#this loops takes the means of the triplicate treatments
colname <- "mean"
i=0
while (i < 7){
colname <- paste(colname, i)
col1 = 2+(i*3)
col2 = 4+(i*3)
ISIP1[[colname]] <- rowMeans( ISIP1[, c(col1:col2)] )
i <- i+1
}

ISIP1<- ISIP1 [-c(2:23)]

names(ISIP1) <- c("name","NoFe_0.5", "Fe_0.5", "NoFe_3", "Fe_3", "NoFe_6", "Fe_6" )

ISIP1 <-  melt (data = ISIP1,id.vars = "name", measure.vars = c(2:7))
ISIP1 <- separate(ISIP1, col = variable, into = c("Fe", "temperature"))
ggplot(ISIP1, aes(x=temperature, y=value, colour = name, shape = Fe ))+
#geom_point(size = 2)+
#stat_summary(fun.y = mean, geom = "line", colour = "black", group =1, size = 1.25)+
#stat_summary(fun.data =  mean_se, geom = "errorbar", colour = "black")+
xlab ("Temperature (°C)")+
ylab ("Expression-Value")+
ggtitle("ISIP2A")+
theme_bw()+
theme(plot.title = element_text(hjust = 0.5))+
theme(axis.text.x = element_text(angle = 50, vjust = 1.0, hjust = 1.0))+
guides(colour=FALSE)+
#scale_color_manual(name = "Treatment", labels = c("+Fe", "-Fe"), values = c("triangle", "square")) +
geom_jitter(width = 0.11, size =2)+
labs (shape = "Treatment")
#scale_y_log10()
#geom_line(aes(group=name))
```




# ORF volcano plot for Frag ISIPs   
```{r echo=FALSE, message=FALSE, warning=FALSE}
ISIP <- dplyr::filter (ORF, grepl('ISIP|isip', name))

#nitratereductase <- dplyr::filter (ORF, grepl('contig_580799_1_929_-|contig_1148680_114_1091_+|contig_1148680_1151_2203_+|contig_1155130_1_1036_+|contig_667814_1_947_-', orf_id))

#volcanoplotinteractive <- function(Dataset, Fold, FDR, volcanontitle)
volcanoplotinteractive(ISIP, "X12_vs_14.log2fc", "X12_vs_14.fdr", "Temp Test: 0C_VS_3C")    
volcanoplotinteractive(ISIP, "X12_vs_16.log2fc", "X12_vs_16.fdr", "Temp Test: 0C_VS_6C")     
volcanoplotinteractive(ISIP, "X14_vs_16.log2fc", "X14_vs_16.fdr", "Temp Test: 3C_VS_6C")
volcanoplotinteractive(ISIP, "X12_vs_13.log2fc", "X12_vs_13.fdr", "Fe Test: 0C_VS_Fe0C")
volcanoplotinteractive(ISIP, "X14_vs_15.log2fc", "X14_vs_15.fdr", "Fe Test: 3C_VS_Fe3C")
volcanoplotinteractive(ISIP, "X16_vs_17.log2fc", "X16_vs_17.fdr", "Fe Test: 6C_VS_Fe6C")
volcanoplotinteractive(ISIP, "X12_vs_15.log2fc", "X12_vs_15.fdr", "Synergy Test: 0C_VS_Fe3C")
volcanoplotinteractive(ISIP, "X12_vs_17.log2fc", "X12_vs_17.fdr", "Synergy Test: 0C_VS_Fe6C")
```


#MCL volcano including all of the clusters (annotated or not) 
```{r}
#volcanoplotinteractive <- function(Dataset, Fold, FDR, volcanontitle)
FragMCL <- dplyr::filter (PseudoMCL, grepl('clust_1814|clust_1154|clust_9740', name))


volcanoplotinteractive(FragMCL, "X12_vs_14.log2fc", "X12_vs_14.fdr", "Temp Test: 0C_VS_3C")
volcanoplotinteractive(FragMCL, "X12_vs_16.log2fc", "X12_vs_16.fdr", "Temp Test: 0C_VS_6C")
volcanoplotinteractive(FragMCL, "X14_vs_16.log2fc", "X14_vs_16.fdr", "Temp Test: 3C_VS_6C")
volcanoplotinteractive(FragMCL, "X12_vs_13.log2fc", "X12_vs_13.fdr", "Fe Test: 0C_VS_Fe0C")
volcanoplotinteractive(FragMCL, "X14_vs_15.log2fc", "X14_vs_15.fdr", "Fe Test: 3C_VS_Fe3C")
volcanoplotinteractive(FragMCL, "X16_vs_17.log2fc", "X16_vs_17.fdr", "Fe Test: 6C_VS_Fe6C")
volcanoplotinteractive(FragMCL, "X12_vs_15.log2fc", "X12_vs_15.fdr", "Synergy Test: 0C_VS_Fe3C")
volcanoplotinteractive(FragMCL, "X12_vs_17.log2fc", "X12_vs_17.fdr", "Synergy Test: 0C_VS_Fe6C")
```
 


# ORF volcano for LHC
```{r}
#LHC <- dplyr::filter (ORF, grepl('LHC|lhc|Lhc', name))


MCLclusterrawplot(FragMCL,'^clust_746$', "Nickel SOD - cluster 746 Frag")
MCLclusterrawplot(PseudoMCL,'^clust_746$', "Nickel SOD - cluster 746 Pseudo-Nit")

MCLclusterrawplot(FragMCL,'^clust_1500$', "Iron/Manganese SOD - cluster 1500Frag")
MCLclusterrawplot(PseudoMCL,'^clust_1500$', "Iron/Manganese SOD - cluster 1500Frag")


MCLclusterrawplot(FragMCL,'^clust_2501$', "Iron/Manganese SOD - cluster 2501Frag")
MCLclusterrawplot(FragMCL,'^clust_366$', "Iron/Manganese SOD - cluster 2501Frag")


LHC <- dplyr::filter (FragORF, grepl('clust_1820 ', name))
      
MCLclusterrawplot(LHC,'^contig_1019282_1_425_+', "PCY")


 MCLclusterrawplot(PseudoMCL,'^clust_1820$', "PCY")
       
                  


LHC <- dplyr::filter (PseudoORF, grepl('clust_1414 ', name))




volcanoplotinteractive(LHC, "X12_vs_14.log2fc", "X12_vs_14.fdr", "Temp Test: 0C_VS_3C")    
volcanoplotinteractive(LHC, "X12_vs_16.log2fc", "X12_vs_16.fdr", "Temp Test: 0C_VS_6C")     
volcanoplotinteractive(LHC, "X14_vs_16.log2fc", "X14_vs_16.fdr", "Temp Test: 3C_VS_6C")
volcanoplotinteractive(LHC, "X12_vs_13.log2fc", "X12_vs_13.fdr", "Fe Test: 0C_VS_Fe0C")
volcanoplotinteractive(LHC, "X14_vs_15.log2fc", "X14_vs_15.fdr", "Fe Test: 3C_VS_Fe3C")
volcanoplotinteractive(LHC, "X16_vs_17.log2fc", "X16_vs_17.fdr", "Fe Test: 6C_VS_Fe6C")
volcanoplotinteractive(LHC, "X12_vs_15.log2fc", "X12_vs_15.fdr", "Synergy Test: 0C_VS_Fe3C")
volcanoplotinteractive(LHC, "X12_vs_17.log2fc", "X12_vs_17.fdr", "Synergy Test: 0C_VS_Fe6C_Frag")
```



```{r}
ORFclusterrawplot <- function(whichdata, whichprotein, graphtitle){
  NiRMCL <- dplyr::filter(whichdata, grepl (whichprotein, name))
NiRMCL <- NiRMCL [c(107, 1:106)]
  NiRMCL <- NiRMCL [-c(2:65, 84:107)]
  names(NiRMCL)<- c("name", "A_NoFe_0.5", "B_NoFe_0.5", "C_NoFe_0.5", "A_Fe_0.5", "B_Fe_0.5", "C_Fe_0.5", "A_NoFe_3", "B_NoFe_3", "C_NoFe_3", "A_Fe_3", "B_Fe_3", "C_Fe_3","A_NoFe_6", "B_NoFe_6", "C_NoFe_6", "A_Fe_6", "B_Fe_6", "C_Fe_6")
  NiRMCL <-  melt (data = NiRMCL,id.vars = "name")
  NiRMCL <- separate(NiRMCL, col = variable, into = c("Rep", "Fe", "temperature"))
  
  ggplot(NiRMCL, aes(x=temperature, y=value, colour = Fe, shape = Rep ))+
    geom_point(size = 3)+
    scale_color_manual(values = c("red", "black"))+
    xlab ("Temperature (°C)")+
    ylab ("")+
    ggtitle(graphtitle)+
    theme_bw()+
    theme(plot.title = element_text(hjust = 0.5))+
    theme(axis.text.x = element_text(angle = 50, vjust = 1.0, hjust = 1.0))+
    #scale_color_manual (name = "", labels = c("+Fe", "-Fe"), values = c("red", "black"))
       guides (color = FALSE, shape = FALSE) 

}


NiRMCL <- dplyr::filter(FragORF, grepl ('contig_1158537_1_423_+', name))


##Cytochrome c6
ORFclusterrawplot(FragORF,'contig_709325_277_602_-', "CytC6") 

ORFclusterrawplot(FragORF,'contig_767007_35_424_+', "CytC6") 


a = ORFclusterrawplot(FragORF,'contig_1175010_45_704_+', 'contig_1175010_45_704_+') 
b = ORFclusterrawplot(FragORF,'contig_1294699_1206_1370_+', 'contig_1294699_1206_1370_+') 
c = ORFclusterrawplot(FragORF,'contig_1294699_769_1095_+', 'contig_1294699_769_1095_+') 
d = ORFclusterrawplot(FragORF,'contig_1315586_1_203_+', 'contig_1315586_1_203_+') 
e = ORFclusterrawplot(FragORF,'contig_1360422_94_705_+', 'contig_1360422_94_705_+') 
f=ORFclusterrawplot(FragORF,'contig_1383095_1_286_+', 'contig_1383095_1_286_+') 
g=ORFclusterrawplot(FragORF,'contig_269925_1_531_-', 'contig_269925_1_531_-') 
h=ORFclusterrawplot(FragORF,'contig_269925_613_777_+', 'contig_269925_613_777_+') 
i=ORFclusterrawplot(FragORF,'contig_301915_1_119_-', 'contig_301915_1_119_-') 
j=ORFclusterrawplot(FragORF,'contig_416319_1_108_+', 'contig_416319_1_108_+') 
k=ORFclusterrawplot(FragORF,'contig_619845_137_895_-', 'contig_619845_137_895_-') 
l=ORFclusterrawplot(FragORF,'contig_691588_22_636_+', 'contig_691588_22_636_+')
m=ORFclusterrawplot(FragORF,'contig_765226_1_562_-', 'contig_765226_1_562_-') 
n=ORFclusterrawplot(FragORF,'contig_88651_465_544_+', 'contig_88651_465_544_+')
o=ORFclusterrawplot(FragORF,'contig_915654_1_462_+', 'contig_915654_1_462_+')


grid.arrange(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o, nrow=5, ncol=3)

```



#still need to figure this out. 
```{r}

#volcanoplot <- function(foldchange, FDR, graphtitle){
  ##volcano <- ORF[c("orf_id", foldchange, FDR)]
  #names(volcano) <- c("gene", "Fold", "FDR")
  #volcano ["group"] <- "no-fold-change"

  ### adding color: this categorizes the data based on significance
  #significant but not large enough fold change
  
  
volcano <- FragMCL[c("name", "X16_vs_17.log2fc" , "X16_vs_17.fdr")]
volcano ["group"] <- "no-fold-change"
names(volcano) <- c( "name", "Fold", "FDR", "group")

volcano [which(volcano['FDR'] < 0.1 & abs(volcano['Fold']) < 2), "group"]<- "nofoldchange_significant" 
  
  # large enough fold change, not significant
  volcano [which(volcano ['FDR'] > 0.1 & abs(volcano['Fold'])> 2), "group"] <- "fold-change_notsignificant"
  
  #Significant and fold change
  volcano [which(volcano ['FDR'] < 0.1 & abs(volcano['Fold']) > 2), "group"] <- "fold-change_significant"

  
  
  
  
  
  

```

#Pie Chart plot
```{r}
df <- data.frame(
  group = c("Male", "Female", "Child"),
  value = c(25, 25, 50)
  )
head(df)



bp<- ggplot(df, aes(x="", y=value, fill=group))+
geom_bar(width = 1, stat = "identity")
bp

pie <- bp + coord_polar("y", start=0)
pie


PracticepieMCL <- dplyr::filter (allMCL, grepl('Fragilariopsis|Diatom|Pseudo-nit', Taxa.group))
PracticepieMCL <- dplyr::filter (PracticepieMCL, grepl('clust_1', cluster))

PracticepieMCL <- PracticepieMCL [, c(1,2, 28,29,30)]


 colname <- "mean"
  i=0
  while (i < 1){
    colname <- paste(colname, i)
    col1 = 2+(i*3)
    #col2 = 4+(i*3)
   PracticepieMCL[[colname]] <- rowMeans( PracticepieMCL[, c(col1:col2)] )
    i <- i+1
  }


PracticepieMCL$mean <- rowMeans(PracticepieMCL[,c(3,4,5)]) 


PracticepieMCL <- PracticepieMCL [, c(1,2,6)]

PracticepieMCL$name <- paste (PracticepieMCL$Taxa.group,"_",PracticepieMCL$cluster)
                              
PracticepieMCL <- PracticepieMCL [, c(4,3)]

getAnywhere('manta.ra')

PracticepieMCL1 <- separate(PracticepieMCL, col=name, into = c("f", "jd", "sjs", "js"))



```

