---
title: "LJ_Frag_analysis"
author: "Loay Jabre"
output: html_document
editor_options: 
  chunk_output_type: console
---
Date Last Editted:    
```{r echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
#this displays the date this file was written 
Sys.time()
```

```{r message=FALSE, warning=FALSE, include=FALSE, results='hide'}

library(shiny)
library(ggplot2)
library(dplyr)
library(plyr)
library(gplots)
library(heatmap.plus)
library(RColorBrewer)
library(reshape2)
library(scales)
library(calibrate)
library(tidyr)
library(plotly)
library(scatterplot3d)
library(rgl)
library(gsubfn)
library(ggrepel)
library(gridExtra)
library(htmlwidgets)


source("fragtranscript_functions.R")
```



```{r message=FALSE, warning=FALSE, include=FALSE}
#Analysis by ORF   

ORF <- read.csv("ORF.csv", header = TRUE, sep = ",")
ORF1 <- ORF [-c(2:4, 6,7, 10:12, 15:21, 23:26, 28, 30:34, 35:46,50:58, 83:106)]

ORF1$name <- paste(ORF1$orf_id, ORF1$kegg_desc, ORF1$KO_desc, ORF1$KO_pathway, ORF1$KOG_desc, ORF1$KOG_class, ORF1$best_hit_annotation, ORF1$PFams_desc, ORF1$TIGRFams_desc)

ORF2 <- ORF1 [-c(1:9)]

ORF2 <- ORF2 [c(28, 1:27)]

ORF2$name <- sub('[.]', '_', make.names(ORF2$name, unique = TRUE))

names(ORF2)<- c("name", "A_T0", "B_T0", "C_T0", "A_B12_0.5", "B_B12_0.5", "C_B12_0.5", "A_B12Fe_0.5", "B_B12Fe_0.5", "C_B12Fe_0.5", "A_0.5", "B_0.5", "C_0.5", "A_Fe_0.5", "B_Fe_0.5", "C_Fe_0.5", "A_3", "B_3", "C_3", "A_Fe_3", "B_Fe_3", "C_Fe_3","A_6", "B_6", "C_6", "A_Fe_6", "B_Fe_6", "C_Fe_6")

#this combines the names of from all of the dataset
ORF$name <- paste(ORF$orf_id, ORF$kegg_desc, ORF$KO_desc, ORF$KO_pathway, ORF$KOG_desc, ORF1$KOG_class, ORF1$best_hit_annotation, ORF1$PFams_desc, ORF1$TIGRFams_desc)
```

#Some notes:    


1) There is a very large spread in the expression values for each transcript For example, some flavodoxin transcripts are orders of magnitude higher than other flavodoxin transcripts. What would be the best way to separate these? I noticed the trends can change if I choose to plot only the ones that have high values or only the ones that have low values. I ended up plotting Log10 values for now.      


2) There are some very apparent trends in the x-y plots. For example, Ferritin shows a strong positive response to Fe addition when you look at the x-y plots. However, this is not reflected in the volcano plots (not statistically significant). 

```{r eval=FALSE, include=FALSE}
with(ORF, plot(X12_vs_13.log2fc, -log10(X12_vs_13.fdr), pch=20, main="Volcano plot", xlim=c(-20,20)))

with(subset(ORF, X12_vs_13.fdr<.05 ), points(X12_vs_13.log2fc, -log10(X12_vs_13.fdr), pch=20, col="red"))

with(subset(ORF, abs(X12_vs_13.log2fc)>1), points(X12_vs_13.log2fc, -log10(X12_vs_13.fdr), pch=20, col="orange"))

with(subset(ORF, X12_vs_13.fdr<.05 & abs(X12_vs_13.log2fc)>1), points(X12_vs_13.log2fc, -log10(X12_vs_13.fdr), pch=20, col="green"))

with(subset(ORF, X12_vs_13.fdr<.05 & abs(X12_vs_13.log2fc)>1), textxy(X12_vs_13.log2fc, -log10(X12_vs_13.fdr), labs=orf_id, cex=.8))

```



The first set of plots are volcano plots comparing two treatments each. For example,the plot "Temp Test: 0C_VS_3C" looks at the transcripts that are negatively (negative Log2 fold change) and positively (positive Log2 fold change) expressed when temperature is increased from 0C to 3C. The dynamic plots are unusabley slow when they're here. But we can look at them individually if you like.  

```{r echo=FALSE, message=FALSE, warning=FALSE}
#if i want to filter out the dataset and look for something in specific
#ISIP1volcano =  dplyr::filter (ORF, grepl('ISIP1|flavodoxin', kegg_desc))

#volcano =  dplyr::filter (ORF, grepl('ISIP|flavodoxin|ferritin|Ferritin', kegg_desc))

volcanoplot("X12_vs_14.log2fc", "X12_vs_14.fdr", "Temp Test: 0C_VS_3C")
volcanoplot("X12_vs_16.log2fc", "X12_vs_16.fdr", "Temp Test: 0C_VS_6C")
volcanoplot("X14_vs_16.log2fc", "X14_vs_16.fdr", "Temp Test: 3C_VS_6C")
volcanoplot("X12_vs_13.log2fc", "X12_vs_13.fdr", "Fe Test: 0C_VS_Fe0C")
volcanoplot("X14_vs_15.log2fc", "X14_vs_15.fdr", "Fe Test: 3C_VS_Fe3C")
volcanoplot("X16_vs_17.log2fc", "X16_vs_17.fdr", "Fe Test: 6C_VS_Fe6C")
volcanoplot("X12_vs_18.log2fc", "X12_vs_18.fdr", "B12 Test: 0C_VS_B12-0C")
volcanoplot("X13_vs_19.log2fc", "X13_vs_19.fdr", "B12 Test: Fe0C_VS_Fe+B12-0C")
volcanoplot("X12_vs_19.log2fc", "X12_vs_19.fdr", "B12 Test: 0C_VS_Fe+B12-0C")
volcanoplot("X13_vs_18.log2fc", "X13_vs_18.fdr", "B12 Test: Fe0C_VS_B12-0C")
volcanoplot("X12_vs_15.log2fc", "X12_vs_15.fdr", "Synergy Test: 0C_VS_Fe3C")
volcanoplot("X12_vs_17.log2fc", "X12_vs_17.fdr", "Synergy Test: 0C_VS_Fe6C")
```

```{r eval=FALSE, include=FALSE}
volcanoplotinteractive("X12_vs_14.log2fc", "X12_vs_14.fdr", "Temp Test: 0C_VS_3C")
volcanoplotinteractive("X12_vs_16.log2fc", "X12_vs_16.fdr", "Temp Test: 0C_VS_6C")
volcanoplotinteractive("X14_vs_16.log2fc", "X14_vs_16.fdr", "Temp Test: 3C_VS_6C")
volcanoplotinteractive("X12_vs_13.log2fc", "X12_vs_13.fdr", "Fe Test: 0C_VS_Fe0C")
volcanoplotinteractive("X14_vs_15.log2fc", "X14_vs_15.fdr", "Fe Test: 3C_VS_Fe3C")
volcanoplotinteractive("X16_vs_17.log2fc", "X16_vs_17.fdr", "Fe Test: 6C_VS_Fe6C")
volcanoplotinteractive("X12_vs_18.log2fc", "X12_vs_18.fdr", "B12 Test: 0C_VS_B12-0C")
volcanoplotinteractive("X13_vs_19.log2fc", "X13_vs_19.fdr", "B12 Test: Fe0C_VS_Fe+B12-0C")
volcanoplotinteractive("X12_vs_19.log2fc", "X12_vs_19.fdr", "B12 Test: 0C_VS_Fe+B12-0C")
volcanoplotinteractive("X13_vs_18.log2fc", "X13_vs_18.fdr", "B12 Test: Fe0C_VS_B12-0C")
volcanoplotinteractive("X12_vs_15.log2fc", "X12_vs_15.fdr", "Synergy Test: 0C_VS_Fe3C")
volcanoplotinteractive("X12_vs_17.log2fc", "X12_vs_17.fdr", "Synergy Test: 0C_VS_Fe6C")

## if I want to label points: 
#geom_text(aes(label=ifelse(FDR<0.05,as.character(gene),'')),hjust=0,vjust=0)
```


```{r eval=FALSE, include=FALSE}

#plot_ly(data = ISIP1volcano, x = ISIP1volcano$X12_vs_13.log2fc, y = -log10(ISIP1volcano$X12_vs_13.fdr), text = ISIP1volcano$kegg_desc, mode = "markers", color = "black")%>% 
  #layout(title ="Volcano Plot")%>%
  #layout(annotations = ISIP1volcano$kegg_desc)

#plot is failing, so the widget helps.
#x = plot_ly(data = ORF, x = ORF$X12_vs_18.log2fc, y = -log10(ORF$X12_vs_18.fdr), text = ORF$name, mode = "markers", color = "red")%>% 
  #layout(title ="Volcano Plot")%>%
  #layout(annotations = ORF$name)
#htmlwidgets::saveWidget(x, "x.html", selfcontained = FALSE)

volcanoplotinteractive("X13_vs_18.log2fc","X13_vs_18.fdr")

volcano <- ORF[c("name", "X13_vs_18.log2fc", "X13_vs_18.fdr")]
  names(volcano) <- c("gene", "Fold", "FDR")
  
  volcano ["group"] <- "nofoldchange_notsignificant"
  
  ### adding color: this categorizes the data based on significance
  #significant but not large enough fold change
  volcano [which(volcano['FDR'] < 0.05 & abs(volcano['Fold']) < 1), "group"]<- "nofoldchange_significant" 
  # large enough fold change, not significant
  volcano [which(volcano ['FDR'] > 0.05 & abs(volcano['Fold'])> 1), "group"] <- "foldchange_notsignificant"
  #Significant and fold change
  volcano [which(volcano ['FDR'] < 0.05 & abs(volcano['Fold']) > 1), "group"] <- "foldchange_significant"
  
volcano_significant <- dplyr::filter (volcano, grepl('foldchange_significant', group))

  
  
  
  
top_peaks <- volcano[with(volcano, order(FDR, Fold)),][1:10,]

top_peaks <- rbind(top_peaks, volcano[with(volcano, order(FDR,-Fold)),][1:10,])
  
a <- list()
for (i in seq_len(nrow(top_peaks))) {
  m <- top_peaks[i, ]
  a[[i]] <- list(
    x = m[["Fold"]],
    y = -log10(m[["FDR"]]),
    text = m[["gene"]],
    xref = "x",
    yref = "y",
    showarrow = TRUE,
    arrowhead = 0.5,
    ax = 20,
    ay = -40
  )
}
  
plot_ly(data = volcano, x = volcano$Fold, y = -log10(volcano$FDR), text = volcano$gene, mode = "markers", color = volcano$group) %>% 
  layout(title ="Volcano Plot")%>%
layout (annotations = a)
```


         
 The next set of plots are specific to transcripts that I thought would react to Fe, temperature and/or B12.     
 
- The different colored dots/lines represent different ORFs of the same transcript.    For example, in the flavodoxin plots, all the yellow dots correspond to one flavodoxin ORF, all the blue dots correspond to another flavodoxin ORF etc.    

- The black line connects the means of all the flavodoxin ORFs under a certain treatment.  

- I also plotted a Log10 expression value because there is a large spread in these values. For example, some flavodoxin ORFs were 2 orders of magnitude higher than other flavodoxin ORFs. 



#ISIPs -    
It seems like ISIP1 has the largest response.   
```{r echo=FALSE, message=FALSE, warning=FALSE}
ISIP <- dplyr::filter (ORF2, grepl('ISIP|isip', name))
ISIP <- ISIP [-c(5:10)]
heatmap(data, ISIP, "ISIP1")
#xyplots(ISIP1, "ISIP1", "ISIP1_treatment_mean", 0, 0.05)
xyplotconcise(ISIP,"All of ISIPs")

ISIP1 <- dplyr::filter (ORF2, grepl('ISIP1', name))
p <- xyplotconcise(ISIP1,"ISIP1")
ggplotly(p)

ISIP2 <- dplyr::filter (ORF2, grepl('ISIP2', name))
xyplotconcise(ISIP2,"ISIP2A")

ISIP3 <- dplyr::filter (ORF2, grepl('ISIP3', name))
xyplotconcise(ISIP2,"ISIP3")
```
         
         
#Flavodoxin
```{r echo=FALSE, message=FALSE, warning=FALSE}
flavodoxin <- dplyr::filter (ORF2, grepl('flavodoxin|Flavodoxin', name))
#heatmap(data, flavodoxin, "flavodoxin")
#heatmap_unclustered(data, flavodoxin, "flavodoxin")
xyplotconcise(flavodoxin,"Flavodoxin")
``` 

```{r eval=FALSE, include=FALSE}

flavodoxin <- dplyr::filter (ORF, grepl('flavodoxin|Flavodoxin', name))

flavodoxin <- flavodoxin[c("name", "X13_vs_18.log2fc", "X13_vs_18.fdr")]
  names(flavodoxin) <- c("gene", "Fold", "FDR")
  
  flavodoxin ["group"] <- "nofoldchange_notsignificant"
  
  ### adding color: this categorizes the data based on significance
  #significant but not large enough fold change
  flavodoxin [which(flavodoxin['FDR'] < 0.05 & abs(flavodoxin['Fold']) < 1), "group"]<- "nofoldchange_significant" 
  # large enough fold change, not significant
  flavodoxin [which(flavodoxin ['FDR'] > 0.05 & abs(flavodoxin['Fold'])> 1), "group"] <- "foldchange_notsignificant"
  #Significant and fold change
  flavodoxin [which(flavodoxin ['FDR'] < 0.05 & abs(flavodoxin['Fold']) > 1), "group"] <- "foldchange_significant"
  
top_peaks <- flavodoxin[with(flavodoxin, order(FDR, Fold)),][1:10,]

top_peaks <- rbind(top_peaks, flavodoxin[with(flavodoxin, order(FDR,-Fold)),][1:10,])

a <- list()
for (i in seq_len(nrow(top_peaks))) {
  m <- top_peaks[i, ]
  a[[i]] <- list(
    x = m[["Fold"]],
    y = -log10(m[["FDR"]]),
    text = m[["gene"]],
    xref = "x",
    yref = "y",
    showarrow = TRUE,
    arrowhead = 0.5,
    ax = 20,
    ay = -40
  )
}

plot_ly(data = flavodoxin, x = flavodoxin$Fold, y = -log10(flavodoxin$FDR), text = flavodoxin$gene, mode = "markers", color = flavodoxin$group) %>% 
  layout(title ="Volcano Plot")%>%
layout (annotations = a)
```


#Ferredoxin
```{r echo=FALSE, message=FALSE, warning=FALSE}
ferredoxin <- dplyr::filter (ORF2, grepl('ferredoxin|Ferredoxin', name))

#heatmap(data, ferredoxin, "ferredoxin")
xyplotconcise(ferredoxin, "Ferredoxin")
```


#Ferritin 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Ferritin <- dplyr::filter (ORF2, grepl('ferritin|Ferritin', name))
#heatmap(data, Ferritin, "ferritin|Ferritin")

#xyplotconcise(Ferritin, "Ferritin")
xyplotsmalldata(Ferritin, "Ferritin")
```


         
#HeatShock 
```{r echo=FALSE, message=FALSE, warning=FALSE}
heatshock <- dplyr::filter (ORF2, grepl('PF00011|Heat.shock|heatshock|HSP', name))

#heatmap_unclustered(data, heatshock, "PF00011")

#heatshock <- dplyr::filter (ORF2, grepl('HSP|heatshock|heat.shock.protein|heat', name))
#xyplotconcise(heatshock,"HSP70")

HSP20 <- dplyr::filter (ORF2, grepl('HSP20C', name))
xyplotconcise(HSP20,"HSP20")

HSP70 <- dplyr::filter (ORF2, grepl('HSP70_1|HSP70_2', name))
#heatmap(data, HSP70, "HSP70")
#xyplots(HSP70, "heatshockproteins", "heatshockproteinsmean", 0, 0.002)
xyplotconcise(HSP70,"HSP70")

HSP90 <- dplyr::filter (ORF2, grepl('HSP90', name))
xyplotconcise(HSP90,"HSP90")
#heatmap(data, HSP90, "HSP90")
```
      
      
#Cold Shock
```{r echo=FALSE, message=FALSE, warning=FALSE}
antifreeze <- dplyr::filter (ORF2, grepl('cold.shock|antifreeze|cspD', name))
#heatmap(data, heatshock, "HSP60")
#heatmap(data, antifreeze, "cold.shock|antifreeze|HSP60")
#xyplots(antifreeze, "antifreezeprotein", "antifreezeprotein_treatment_mean", 0, 0.01)
xyplotconcise(antifreeze,"Cold Shock Proteins")


antifreeze <- dplyr::filter (ORF2, grepl('cold.shock|HSP60', name))

#heatmap_unclustered(data, heatshock, "HSP60")

#scatterplot3d(antifreeze[13:15], 
              #angle = 20)
```
      
      
      
#B12 Response
```{r echo=FALSE, message=FALSE, warning=FALSE}
MetH  <- dplyr::filter (ORF2, grepl('MetH|metH', name))
MetE <- dplyr::filter (ORF2, grepl('Cobalamin.independent|cobalamin.independent', name))
CBA1 <- dplyr::filter (ORF2, grepl('CBA1', name))

MetE_CBA1 <- dplyr::filter (ORF2, grepl('Cobalamin.independent|CBA1', name))

#heatmap(data, MetH, "metH|METH")
#xyplots(MetH, "MetH", "MetH_treatment_mean", 0, 0.01)
#heatmap(data, MetE, "Cobalamin|CBA")
#xyplots(MetE, "MetE+CBA1", "MetE+CBA1_treatment_mean", 0, 0.01)

xyplotconcise(MetH,"MetH")
xyplotconcise(MetE,"MetE")
xyplotconcise(CBA1,"CBA1")
xyplotconcise(MetE_CBA1,"MetE+CBA1")
```
   
   
   
#Nitrite Reductase
```{r echo=FALSE, message=FALSE, warning=FALSE}
Nitr <- dplyr::filter (ORF2, grepl('nitrite|Nitrite', name))
#heatmap(group, ORF2, 'NIR')
#heatmap_unclustered(group, ORF2, 'NIR_2')
#xyplots(Nitr, "MetH", "MetH_treatment_mean", 0, 0.01)

xyplotconcise(Nitr,"Nitrite Reductase")

#Nitr <- dplyr::filter (ORF2, grepl('nitrate|Nitrate|nitrite|Nitrite', name))

#heatmap(group, ORF2, 'NIR')

#heatmap_unclustered(group, ORF2, 'NIR_2')
```

  
  
#Rubisco
```{r echo=FALSE, message=FALSE, warning=FALSE}
#rubisco <- dplyr::filter (ORF2, grepl('RBL', name))
#fixdata(rubisco, 'RBL', "Rubisco", "Rubiscomean")

rubisco <- dplyr::filter (ORF2,grepl('RBL|RuBisCO|rubisco|RUBISCO',name))
xyplotconcise(rubisco, "RuBisCO")
```
   
   
   
#Photosystem II Light harvesting
```{r echo=FALSE, message=FALSE, warning=FALSE}
Lhcf <- dplyr::filter (ORF2, grepl('Lhcf|lhcf', name))
xyplotconcise(Lhcf, "All of Light Harvesting Complexes F ")

Lhcf1 <- dplyr::filter (ORF2, grepl('Lhcf1', name))
xyplotconcise(Lhcf1, "LHCF1")

Lhcf4 <- dplyr::filter (ORF2, grepl('Lhcf4', name))
xyplotconcise(Lhcf4, "LHCF4")

Lhcf7 <- dplyr::filter (ORF2, grepl('Lhcf7', name))
xyplotsmalldata(Lhcf7, "LHCF7")

Lhcf9 <- dplyr::filter (ORF2, grepl('Lhcf9', name))
xyplotconcise(Lhcf9, "LHCF9")
#xyplotsmalldata(Lhcf9, "LHCF9")

Lhcf16 <- dplyr::filter (ORF2, grepl('Lhcf16', name))
xyplotconcise(Lhcf16, "LHCF16")

#fucoxanthin <- dplyr::filter (ORF2, grepl('fucoxanthin', name))
#xyplotconcise(fucoxanthin, "Fucoxanthin")

#Lhca <- dplyr::filter (ORF2, grepl('Lhca', name))
#xyplotconcise(Lhca, "fucoxanthin")
```
  
  
#LI818 (Light harvesting complex X) -    

used in photoprotection / stress induced
```{r echo=FALSE, message=FALSE, warning=FALSE}
Lhcx5 <- dplyr::filter (ORF2, grepl('lhcx5', name))
xyplotconcise(Lhcx5, "LHCX5")

Lhcx6 <- dplyr::filter (ORF2, grepl('Lhcx6', name))
xyplotconcise(Lhcx6, "LHCX6")
```


# Photosystem II Core Antennae        

psbY is a manganese binding protein in PSII
```{r echo=FALSE, message=FALSE, warning=FALSE}
PsbY <- dplyr::filter (ORF2, grepl('PsbY', name))
xyplotsmalldata(PsbY,"PsbY")

CP47 <- dplyr::filter (ORF2, grepl('CP47', name))
#xyplotsmalldata(CP47,"CP47")
#heatmap_unclustered(group, CP47, 'CP47')
#CP47 or CPa-1, (encoded by PsbB gene): Proximal antennae  
xyplotconcise(CP47, "CP47")
#xyplotsmalldata(CP47,"CP47")
#heatmap(grou, CP47, 'CP47')

CP43 <- dplyr::filter (ORF2, grepl('CP43|psbC', name))
xyplotsmalldata(CP43,"CP43")

#xyplotconcise(CP43, "CP43")
#CP43,or CPa-2, (encoded by PsbC gene): Proximal antennae 

#heatmap(chloro, ORF2, 'Photosystem_II|photosystem_II|PSII|photosystemII')

#heatmap(chloro, ORF2, 'PsbA')

#heatmap_unclustered(chloro, ORF2, 'PsbY')

#heatmap_unclustered(chloro, ORF2, 'PsbD')

#heatmap(chloro, ORF2, 'PsbO')

#heatmap(chloro, ORF2, 'CP47')

#PsbY <- dplyr::filter (ORF2, grepl('PsbO', name))
#fixdata(PsbY, 'PsbO', "PsbY", "PsbYmean")
```




#Photosystem II Reaction Center     

D1 (gene: PsbA), QB     

D2 (gene: PsbD), QA    

Cytochrome c550 (gene: PsbV)    
```{r echo=FALSE, message=FALSE, warning=FALSE}
D1 <- dplyr::filter (ORF2, grepl('center.D1|protein.D1|em.II.D1|PsbA', name))
#xyplotsmalldata(D1,"D1")
xyplotconcise(D1, "D1")

D2 <- dplyr::filter (ORF2, grepl('center.D2|protein.D2|em.II.D2', name))
xyplotsmalldata(D2,"D2")
#xyplotconcise(D2, "D2")

Psb <- dplyr::filter (ORF2, grepl('PsbQ|PsbO|PsbP', name))
xyplotsmalldata(Psb,"PSII oxygen-evolving complex (Psb O,P,Q)")
#xyplotconcise(Psb, "PSII oxygen-evolving complex (Psb O,P,Q)")

PsbO <- dplyr::filter (ORF2, grepl('PsbO', name))
xyplotsmalldata(PsbO,"Manganese Stabilizing Protein (PsbO)")

PsbP <- dplyr::filter (ORF2, grepl('PsbP', name))
xyplotsmalldata(PsbP,"PsbP")
#xyplotconcise(PsbP, "PsbP")

PsbQ <- dplyr::filter (ORF2, grepl('PsbQ', name))
xyplotsmalldata(PsbQ,"PsbQ")

Cyt_c550 <- dplyr::filter (ORF2, grepl('c.550|psbV', name))
xyplotsmalldata(Cyt_c550,"Cyt_c550")
#xyplotconcise(Cyt_c550, "Cyt_c550")

#cytb559 is a heterodiamer (PsbE and PsbF ) with a heme cofactor 
#unclear function, likely involved in photoprotection
Cyt_b559 <- dplyr::filter (ORF2, grepl('psbE|psbF|PF00284', name))
xyplotconcise(Cyt_b559, "Cyt_b559")
#heatmap_unclustered(group, Cyt_b559, 'b559|psbF')
#xyplotsmalldata(Cyt_b559, "cytoc_b559")
```


#Plastoquinone
```{r echo=FALSE, message=FALSE, warning=FALSE}
PQ <- dplyr::filter (ORF2, grepl('plastoquinone', name))
xyplotconcise(PQ, "Plastoquinone")

#NDH <- dplyr::filter (ORF2, grepl('NDH', name))
#xyplotconcise(NDH, "CytC")
```



#B6F
```{r echo=FALSE, message=FALSE, warning=FALSE}
Rieske <- dplyr::filter (ORF2, grepl('Rieske|rieske', name))
xyplotconcise(Rieske,"Rieske iron-sulfur protein")
#xyplotsmalldata(Rieske, "Rieske")

#CytC <- dplyr::filter (ORF2, grepl('fumarate', name))
#xyplotconcise(CytC,"CytC")
B6F <- dplyr::filter (ORF2, grepl('b6f|B6F', name))
xyplotsmalldata(B6F,"Cyt b6f")

#Cytochrome <- dplyr::filter (ORF2, grepl('cytochrome|Cytochrome|cytoc|Cytoc', name))
#xyplotconcise(Cytochrome, "Cytochrome")

#CPF <- dplyr::filter (ORF2, grepl('CPF', name))
#xyplotsmalldata(CPF,"CP43")
#xyplotconcise(CPF, "CP43")

#heatmap_unclustered(chloro, ORF2, 'b6f')
```
    
    
 
#Plastocyanin 
```{r echo=FALSE, message=FALSE, warning=FALSE}
Plasto <- dplyr::filter (ORF2, grepl('plastocyanin|PCY|Plastocyanin', name))
xyplotconcise(Plasto, "Plastocyanin")
```
 

```{r eval=FALSE, message=FALSE, warning=FALSE, include=FALSE}
#Photosystem 1

P700 <- dplyr::filter (ORF2, grepl('P700', name))
xyplotconcise(P700, "P700")

PsaA <- dplyr::filter (ORF2, grepl('PsaA', name))
xyplotconcise(PsaA, "PsaA")
xyplotsmalldata(PsaA, "PsaA")

PsaB <- dplyr::filter (ORF2, grepl('PsaB', name))
xyplotconcise(PsaB, "PsaB")
xyplotsmalldata(PsaB, "PsaB")

PsaE <- dplyr::filter (ORF2, grepl('PsaE', name))
xyplotconcise(PsaE, "PsaE")

LHCA <- dplyr::filter (ORF2, grepl('lhcA', name))
xyplotsmalldata(LHCA, "PSI LHC-A")
xyplotconcise(LHCA, "PSI- LHCA")

heatmap_unclustered(chloro, ORF2, 'PsaA')

heatmap_unclustered(chloro, ORF2, 'PsaB')

heatmap(chloro, ORF2, 'PsaE')
```

